<!-- markdownlint-disable MD009 MD013 MD028 MD033 MD031 -->

# ✨ VNULIB DOWNLOADER ✨

<pre align="center">
██╗   ██╗███╗   ██╗██╗   ██╗██╗     ██╗██████╗ 
██║   ██║████╗  ██║██║   ██║██║     ██║██╔══██╗
██║   ██║██╔██╗ ██║██║   ██║██║     ██║██████╔╝
╚██╗ ██╔╝██║╚██╗██║██║   ██║██║     ██║██╔══██╗
 ╚████╔╝ ██║ ╚████║╚██████╔╝███████╗██║██████╔╝
  ╚═══╝  ╚═╝  ╚═══╝ ╚═════╝ ╚══════╝╚═╝╚═════╝ 

██████╗  ██████╗ ██╗    ██╗███╗   ██╗██╗      ██████╗  █████╗ ██████╗ ███████╗██████╗ 
██╔══██╗██╔═══██╗██║    ██║████╗  ██║██║     ██╔═══██╗██╔══██╗██╔══██╗██╔════╝██╔══██╗
██║  ██║██║   ██║██║ █╗ ██║██╔██╗ ██║██║     ██║   ██║███████║██║  ██║█████╗  ██████╔╝
██║  ██║██║   ██║██║███╗██║██║╚██╗██║██║     ██║   ██║██╔══██║██║  ██║██╔══╝  ██╔══██╗
██████╔╝╚██████╔╝╚███╔███╔╝██║ ╚████║███████╗╚██████╔╝██║  ██║██████╔╝███████╗██║  ██║
╚═════╝  ╚═════╝  ╚══╝╚══╝ ╚═╝  ╚═══╝╚══════╝ ╚═════╝ ╚═╝  ╚═╝╚═════╝ ╚══════╝╚═╝  ╚═╝

Python CLI tool download sách từ <strong>VNULIB</strong>
</pre>

<div>
  <a href="../../commits/main"><img src="https://img.shields.io/github/last-commit/KevinNitroG/VNULIB-Downloader?style=for-the-badge&color=f4dbd6" alt="GitHub last commit (by committer)"></a>
  <img alt="Lines of code" src="https://img.shields.io/tokei/lines/github/KevinNitroG/VNULIB-Downloader?style=for-the-badge&color=f0c6c6">
<img src="https://img.shields.io/github/repo-size/KevinNitroG/VNULIB-Downloader?style=for-the-badge&color=f5bde6" alt="GitHub repo size">
  <a href="../../graphs/contributors"><img src="https://img.shields.io/github/contributors/KevinNitroG/VNULIB-Downloader?style=for-the-badge&color=c6a0f6" alt="GitHub contributors"></a>
  <img src="https://hits.sh/github.com/KevinNitroG/VNULIB-Downloader.svg?view=today-total&style=for-the-badge&label=hits" alt="Hit">
  <br>
  <br>
  <a href="https://wakatime.com/badge/github/KevinNitroG/VNULIB-Downloader"><img src="https://wakatime.com/badge/github/KevinNitroG/VNULIB-Downloader.svg?style=for-the-badge" alt="Wakatime"></a>
  <a href="https://www.codefactor.io/repository/github/kevinnitrog/VNULIB-Downloader"><img src="https://img.shields.io/codefactor/grade/github/KevinNitroG/VNULIB-Downloader?style=for-the-badge" alt="CodeFactor Grade"></a>
  <a href="../../../actions/workflows/release.yml"><img src="https://img.shields.io/github/actions/workflow/status/KevinNitroG/VNULIB-Downloader/release.yml?style=for-the-badge&label=RELEASE" alt="Release Status"></a>
  <a href="../../../actions/workflows/code-check.yml"><img src="https://img.shields.io/github/actions/workflow/status/KevinNitroG/VNULIB-Downloader/code-check.yml?style=for-the-badge&label=CODE%20CHECK" alt="Code check status"></a>
  <br>
  <br>
  <a href="https://app.deepsource.com/gh/KevinNitroG/VNULIB-Downloader/"><img src="https://app.deepsource.com/gh/KevinNitroG/VNULIB-Downloader.svg/?label=active+issues&show_trend=true&token=CudEDrOLrCKS4df1IaYBoP-G" alt="DeepSource active issues"></a>
  <a href="https://app.deepsource.com/gh/KevinNitroG/VNULIB-Downloader/"><img src="https://app.deepsource.com/gh/KevinNitroG/VNULIB-Downloader.svg/?label=resolved+issues&show_trend=true&token=CudEDrOLrCKS4df1IaYBoP-G" alt="DeepSource resolved issues"></a>
  <br>
  <br>
  <img src="https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54" alt="Python">
  <img src="https://img.shields.io/badge/shell_script-%23121011.svg?style=for-the-badge&logo=gnu-bash&logoColor=white" alt="Shell Script">
  <img src="https://img.shields.io/badge/-selenium-%43B02A?style=for-the-badge&logo=selenium&logoColor=white" alt="Selenium">
  <img src="https://img.shields.io/badge/pre--commit-FAB040.svg?style=for-the-badge&logo=precommit&logoColor=white" alt="Pre-commit">
  <img src="https://img.shields.io/badge/github%20actions-%232671E5.svg?style=for-the-badge&logo=githubactions&logoColor=white" alt="GitHub Actions">
  <br>
  <br>
  <a href="../../../releases/latest"><img alt="Release" src="https://img.shields.io/github/v/release/KevinNitroG/VNULIB-Downloader?sort=date&display_name=tag&style=for-the-badge&color=eed49f"></a>
  <a href="../../../releases/latest"><img alt="Download Count" src="https://img.shields.io/github/downloads/KevinNitroG/VNULIB-Downloader/total?style=for-the-badge&color=8bd5ca"></a>
</div>

<!-- ![Markdown](https://img.shields.io/badge/markdown-%23000000.svg?style=for-the-badge&logo=markdown&logoColor=white)
<a href="../../issues"><img src="https://img.shields.io/github/issues-raw/KevinNitroG/VNULIB-Downloader?style=for-the-badge&color=ffadad" alt="GitHub issues"></a>
<a href="../../issues"><img src="https://img.shields.io/github/issues-closed/KevinNitroG/VNULIB-Downloader?style=for-the-badge&color=%23ffc6ff" alt="GitHub closed issues"></a> -->

---

- [✨ VNULIB DOWNLOADER ✨](#-vnulib-downloader-)
  - [🎆 CHỨC NĂNG](#-chức-năng)
  - [🥂 DEMO](#-demo)
  - [🪴 HƯỚNG DẪN SỬ DỤNG](#-hướng-dẫn-sử-dụng)
    - [1️⃣ Tải tool](#1️⃣-tải-tool)
    - [2️⃣ Sử dụng](#2️⃣-sử-dụng)
  - [⚙️ NÂNG CAO](#️-nâng-cao)
    - [🗃️ Pre-config](#️-pre-config)
    - [⛏️ Command line arguments](#️-command-line-arguments)
    - [🤐 Python](#-python)
  - [🤔 NOTES](#-notes)
    - [Giải thích thuật ngữ](#giải-thích-thuật-ngữ)
  - [👨‍💻 DEVELOP / CONTRIBUTE](#-develop--contribute)
  - [📓 TODO](#-todo)
  - [📝 LICENSE](#-license)
  - [🤥 DISCLAIMER](#-disclaimer)
  - [😌 CREDIT](#-credit)
  - [⭐ STARGAZER](#-stargazer)

---

## 🎆 CHỨC NĂNG

- Tải sách _(có thể đọc preview online)_ trên [VNULIB](https://vnulib.edu.vn/) _(HCM)_
  > Ví dụ: [https://ir.vnulib.edu.vn/handle/VNUHCM/8108]([https://ir.vnulib.edu.vn/handle/VNUHCM/8108)
- Hỗ trợ link: `book`, `preview`, `page` [<sup>?</sup>](#giải-thích-thuật-ngữ)
- Hỗ trợ tải nhiều sách _(lần lượt từng sách)_
- Tải sách - Multithreading[<sup>?</sup>](#giải-thích-thuật-ngữ)
- Tạo PDF các file sách - Multiprocessing[<sup>?</sup>](#giải-thích-thuật-ngữ)
- Xoá ảnh sau khi tải _(phù hợp khi dùng tạo PDF)_

---

## 🥂 DEMO

- Chưa có nha chờ kiếp sau

---

## 🪴 HƯỚNG DẪN SỬ DỤNG

### 1️⃣ Tải tool

- [![Windows](https://img.shields.io/badge/Windows-8aadf4?style=for-the-badge&logo=windows&logoColor=white)](https://github.com/KevinNitroG/VNULIB-Downloader/releases/latest/download/VNULIB-Downloader-windows.exe)
- [![Mac OS](https://img.shields.io/badge/MAC_OS-ed8796?style=for-the-badge&logo=apple&logoColor=white)](https://github.com/KevinNitroG/VNULIB-Downloader/releases/latest/download/VNULIB-Downloader-macos)
- [![Linux](https://img.shields.io/badge/Linux-5b6078?style=for-the-badge&logo=linux&logoColor=white)](https://github.com/KevinNitroG/VNULIB-Downloader/releases/latest/download/VNULIB-Downloader-linux)

> [!NOTE]
>
> Linux + Mac: Nếu file executable không có quyền thực thi thì hãy dùng lệnh `chmod +x ./VNULIB-Downloader*`

### 2️⃣ Sử dụng

> [!IMPORTANT]
>
> Cần cài đặt trình duyệt [Chrome](https://www.google.com/chrome/) _(cần cho Selenium Webdriver)_

1. Mở tool
2. Input

| **VARIABLE**                                    | **VALUE**                                   | **DEFAULT** | **DESCRIPTION**                                                              | **EXAMPLE**     |
| ----------------------------------------------- | ------------------------------------------- | ----------- | ---------------------------------------------------------------------------- | --------------- |
| `USERNAME`                                      | `string`                                    |             | Username tài khoản                                                           | `1500023520000` |
| `PASSWORD`                                      | `string`                                    |             | Password tài khoản                                                           | `examplePass`   |
| `LINKS`                                         | `string string ...`                         |             | Link ảnh trang sách<br>_(Có thể nhiều sách, cách nhau bằng khoảng cách)_     | `link_1 link_2` |
| `TIMEOUT`                                       | `int`                                       | `20`        | Timeout _(s)_ khi sử dụng Selenium và request lấy mỗi ảnh từ server          | `20`            |
| `BROWSER`                                       | `chrome`,<br> `path/to/local/chrome_driver` | `chrome`    | Trình duyệt để sử dụng Selenium Webdriver khi có cần xử lý `book`, `preview` | `chrome`        |
| `HEADLESS`[<sup>?</sup>](#giải-thích-thuật-ngữ) | `y`, `n`, ...                               | `y`         | Selenium Webdriver headless mode                                             | `y`             |
| `CREATE_PDF`                                    | `y`, `n`, ...                               | `y`         | Tạo file PDF từ các ảnh đã tải về                                            | `y`             |
| `CLEAN_IMG`                                     | `y`, `n`, ...                               | `y`         | Xoá ảnh sau khi đã tạo PDF                                                   | `y`             |

> [!WARNING]
>
> - Vì sử dụng Multithreading, nếu tải quá nhiều sách có thể ảnh hưởng đến server

> [!IMPORTANT]
>
> - Nếu trong tương lai việc sử dụng link `book` hay `preview` không được, hãy thử link `page` _(vì các phần tử trang web
>   có thể thay đổi)_

> [!NOTE]
>
> - Ảnh và sách sẽ được tải về `./Downloads/`
> - Kiểm tra log tại `./log/`
> - Trong quá trình tải ảnh của sách, nếu quá thời gian `TIMEOUT` thì trang sẽ huỷ tải, thay bằng ảnh [error](../assets/images/error_page.jpg)

> [!TIP]
>
> - Khi có >= 1 link là `book` / `preview`: Tool sẽ sử dụng Selenium Webdriver để xử lý, cần phải dùng tài khoản thư viện để login
> - Trái lại, khi toàn bộ link là `page`: Tool không cần dùng Selenium Webdriver, nên `USERNAME`, `PASSWORD`, `BROSWER`, `HEADLESS` không còn quan trọng _(nhập bừa / để trống)_
> - `page` link: Trong link có query `&page=`:
>   - `1`: Tool sẽ tự động check và tải trang sách đến khi đạt giới hạn _(Single thread)_
>   - \> `1`: Tool tự nhận đấy là limit của file sách hoặc chủ đích sử dụng _(Multithreading)_

---

## ⚙️ NÂNG CAO

- Có thể chạy tool theo các cách:
  - [Pre config](#️-pre-config)
  - [Command line arguments](#️-command-line-arguments)
  - [Python](#-python)

> [!NOTE]
>
> Thứ tự ưu tiên giá trị biến: `arguments` > `config.yml` > `user input`

### 🗃️ Pre-config

- Để không phải nhập input mỗi lần chạy

1. Tạo file `config.yml` bằng 1 trong 2 cách:
   - Chạy trước tool 1 lần sẽ tự tạo file `config.yml`
   - Copy nội dung của file [`config-sample.yml`](../VNULIB-Downloader/config-sample.yml) và paste vào
     file `config.yml`
2. Chỉnh `config.yml`

### ⛏️ Command line arguments

- Windows:
  ```.ps1
  .\VNULIB-Downloader-windows.exe --help
  ```
- Mac OS:
  ```sh
  ./VNULIB-Downloader-macos --help
  ```
- Linux:
  ```sh
  ./VNULIB-Downloader-linux --help
  ```
- Ví dụ _(Windows)_:
  ```.ps1
  .\VNULIB-Downloader-windows.exe --link "link1" "link2" --username "1500023520000" --password "examplePass" --browser "~/chrome_driver.exe" --headless --create-pdf --clean-imgs
  ```

### 🤐 Python

1. Install [Python](https://www.python.org/downloads/)
2. Clone repo
   ```.ps1
   git clone "https://github.com/KevinNitroG/VNULIB-Downloader" --depth 1 --filter=blob:none
   ```
3. Create virtual environment _(optional)_

   - Create virtual environment
     ```.ps1
     python -m venv .venv
     ```
   - Active virtual environment
     - For Windows
       ```.ps1
       .venv\Scripts\activate
       ```
     - For Mac / Linux
       ```.sh
       source .venv/bin/activate
       ```
   - Deactive virtual environment
     ```.sh
     deactivate
     ```

4. Install requirements

   ```ps1
   pip install -r requirements/requirements.txt
   ```

5. Run tool

   ```ps1
   python main.py
   ```

> [!NOTE]
>
> **Linux** / **Mac** hãy thử `pip3` và `python3` nếu `pip` và `python` không chạy

---

## 🤔 NOTES

### Giải thích thuật ngữ

| **TERM**             | **EXPLANTION**                                                      | **EXAMPLE**                                                                                                                                                                                                                                                                                              |
| -------------------- | ------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `book`               | Link của sách                                                       | `https://ir.vnulib.edu.vn/handle/VNUHCM/8108`                                                                                                                                                                                                                                                            |
| `preview`            | Preview link của sách                                               | `https://ir.vnulib.edu.vn/flowpaper/?bitsid=4e5aa1b6-d1fb-4478-9740-ad9a8558ee62`<br>or<br>`https://ir.vnulib.edu.vn/flowpaper/simple_document.php?subfolder=69/37/45/&doc=69374546227582323703697992942653251709&bitsid=4e5aa1b6-d1fb-4478-9740-ad9a8558ee62&uid=63a80468-b67g-4ab0-855b-f4df246b123iy` |
| `page`               | Link ảnh của 1 trang sách                                           | `https://ir.vnulib.edu.vn/flowpaper/services/view.php?doc=69374546227582323703697992942653251709&format=jpg&page=1&subfolder=69/37/45/`                                                                                                                                                                  |
| `Selenium Webdriver` | Hỗ trợ automation bằng trình duyệt                                  | -                                                                                                                                                                                                                                                                                                        |
| `headless`           | Khi chạy trình duyệt sẽ không hiện ra thành cửa sổ, chỉ ẩn dưới nền | -                                                                                                                                                                                                                                                                                                        |
| `Multithreading`     | Đa luồng                                                            | -                                                                                                                                                                                                                                                                                                        |
| `Multiprocessing`    | Đa xử lý                                                            | -                                                                                                                                                                                                                                                                                                        |

> [!NOTE]
>
> - Download các ảnh cho lần lượt từng link. 1 link sẽ có nhiều ảnh. Multithreading để tải các ảnh của 1 sách đồng thời _(concurrent)_
> - Merge song song từng folder thành PDF, phụ thuộc vào số nhân CPU _(parallel)_

---

## 👨‍💻 DEVELOP / CONTRIBUTE

| **TYPE**        | **NAME**          | **NOTE**                                                                                                                                                                                                        |
| --------------- | ----------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| LSP             | Pylance / Pyright | Use either Pylance or Pyright                                                                                                                                                                                   |
| Linter          | Ruff              | Include Isort rules                                                                                                                                                                                             |
| Formatter       | Ruff              | ↑                                                                                                                                                                                                               |
| Formatter       | Prettier          | -                                                                                                                                                                                                               |
| Docstring       | Google            | - [Ex 1](https://github.com/NilsJPWerner/autoDocstring/blob/master/docs/google.md#google-docstring-format)<br>- [Ex 2](https://gist.github.com/Raxy45/98de280aec506e7168cbb5955242ec3f/#file-google_docstrings) |
| Package Manager | Pip               | Need specifying dependencies' versions                                                                                                                                                                          |
| Commit message  | Gitmoji           | I have messed up the commit messages 🥴                                                                                                                                                                         |
| End of line     | LF                | -                                                                                                                                                                                                               |

> [!NOTE]
>
> Use Google's docstring format with always noting the types of variables even they are in parameters of functions / methods

---

## 📓 TODO

- [ ] Support more browsers _(inherited from which class?)_
- [ ] Options to enable Multithreading, Multiprocessing
- [ ] Update tool option using command line arguments
- [ ] Merge PDF for book which has multiple files

> Cần người có lòng hảo tâm contribute 🫠

---

## 📝 LICENSE

[![License: MIT](https://img.shields.io/badge/License-MIT-9bf6ff?style=for-the-badge)](./LICENSE)

---

## 🤥 DISCLAIMER

Dự án không dưới quyền [VNULIB](https://vnulib.edu.vn/) hay bất kì tổ chức nào khác. Dự án chỉ mang tính học tập _(thực hành, làm việc nhóm, sử dụng ngôn ngữ lập trình, tổ chức một dự án, sử dụng Git, Github, CI/CD)_, không có mục đích thương mại, phá hoại _(DDOS,...)_. Xin hãy tuân thủ luật sở hữu trí tuệ, không in ấn có tổ chức,... Chúng tôi không chịu trách nhiệm cho bất kì kết quả và hậu quả nào của việc sử dụng tool.

---

## 😌 CREDIT

- Inspired by [vnulib_downloader](https://github.com/tlatonf/vnulib_downloader/)

---

## ⭐ STARGAZER

<a href="https://star-history.com/#KevinNitroG/VNULIB-Downloader&Timeline">
  <picture>
    <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=KevinNitroG/VNULIB-Downloader&type=Timeline&theme=dark" />
    <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=KevinNitroG/VNULIB-Downloader&type=Timeline" />
    <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=KevinNitroG/VNULIB-Downloader&type=Timeline" />
  </picture>
</a>

<!-- markdownlint-disable MD012 -->
